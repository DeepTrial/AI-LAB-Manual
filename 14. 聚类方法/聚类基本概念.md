# 聚类基本概念

聚类是针对给定的样本，依据它们的特征相似度或距离，将其归并到若干个“类”或”簇“的算法。一个类是给定样本的子集。直观上相似的样本会聚集在一起，不相似的样本会分在不同的类。



聚类属于无监督学习方法。常用的聚类算法有：

- 层次聚类
- k均值聚类

不同的聚类算法包含一些相似的概念，包括：样本间距离或相似度，类或簇，类内距离。



## 1.距离或相似度

聚类的核心概念是相似度或距离。目前有多种相似度或聚类的定义。由于相似度直接影响聚类的结果，所以选择距离计算方式是聚类算法的根本问题。

### 1.1 闵可夫斯基距离

聚类问题中，样本集合可看作是向量空间中的集合，以相应空间的距离表示样本之间的相似度。闵可夫斯基距离（包含了欧氏距离）是最常用的距离度量方式，距离越大的样本相似度越小。

> 给定样本集$X$，$X$是m维实数向量空间中点的集合，$x_i=(x_{1i},x_{2i},...,x_{mi})^T,x_j=(x_{1j},x_{2j},...,x_{mj})^T$,样本$x_i$与样本$x_j$的闵可夫斯基距离定义为：
> $$
> d_{ij}=\left(\sum_{k=1}^m|x_{ki}-x_{kj}|^P\right)^{\frac{1}{p}} , p>=1
> $$
> 

- 当$p=1$时，闵可夫斯基距离就是曼哈顿距离:    $d_{ij}=\sum_{k=1}^m|x_{ki}-x_{kj}|$

- 当$p=2$时，闵可夫斯基距离就是欧氏距离:   $d_{ij}=\left(\sum_{k=1}^m|x_{ki}-x_{kj}|^2\right)^{\frac{1}{2}}$

- 当$p=\infty$时，闵可夫斯基距离就是切比雪夫距离：$d_{ij}=max_k|x_{ki}-x_{kj}|$

### 1.2 马哈拉诺比斯距离

简称马氏距离，其考虑各个分量（特征）之间的相关性并与各个分量的尺度无关。马氏距离越大相似度越小

> 给定样本集$X$，$X=[x_{ij}]_{m \times n}$,其协方差矩阵为$S$，$x_i=(x_{1i},x_{2i},...,x_{mi})^T,x_j=(x_{1j},x_{2j},...,x_{mj})^T$, 样本$x_i$与样本$x_j$的马哈拉诺比斯距离定义为：
> $$
> d_{ij}=[(x_i-x_j)^TS^{-1}(x_i-x_j)]^{\frac{1}{2}}
> $$

当协方差矩阵为单位矩阵时，马氏距离就是欧氏距离



### 1.3 相关系数

相关系数越接近1，表示样本越相似；越接近0，表示样本越不相似。

> 样本$x_i$与样本$x_j$的相关系数定义为：
> $$
> r_{ij}=\frac{\sum_{k=1}^m(x_{ki}-\bar{x}_i)(x_{kj}-\bar{x}_j)}{\left[\sum_{k=1}^m(x_{ki}-\bar{x}_i)^2\sum_{k=1}^m(x_{kj}-\bar{x}_j)^2\right]^\frac{1}{2}}
> $$
> 其中：
> $$
> \bar{x}_i=\frac{1}{m}\sum_{k=1}^mx_{ki}, \quad \bar{x}_j=\frac{1}{m}\sum_{k=1}^mx_{kj}
> $$

### 1.4 余弦距离

样本之间的相似度还可以用夹角余弦来表示，夹角余弦越接近1，表示样本越相似；越接近0，表示样本越不相似。

> 样本$x_i$与样本$x_j$的夹角余弦定义为：
> $$
> s_{ij}=\frac{\sum_{k=1}^mx_{ki}x_{kj}}{[\sum_{k=1}^mx^2_{ki}\sum_{k=1}^mx^2_{kj}]^\frac{1}{2}}
> $$

需要注意的是，不同的相似度度量得到的结果并不一定一致，可能会相反。



## 2.类或簇

通过聚类得到的类或簇，本质是样本的子集。

- 软聚类。一个样本可以属于多个类，或不同类的交集不为空
- 硬聚类。一个样本只能属于一个类，或不同类的交集为空

类或簇有多种定义，最常用的包括：

> 设T为给定的正数，若集合G中任意两个样本$x_i,x_j$，有$d_{ij}<=T$,则称G为一个类或簇

由此定义，统计学习方法P259页推导了其他三种定义方式。

在已知类的定义后，类的特征可以通过不同的角度刻画，常用的特征包括：

- 类的中心：
  $$
  \bar{x}_G=\frac{1}{n_G}\sum_{i=1}^{n_G}x_i
  $$
  其中$n_G$是类G的样本个数

- 类的直径$D_G$：类中任意两个样本的最大距离
  $$
  D_G=\mathop{\max}_{x_i,x_j \in G} d_{ij}
  $$
  
- 类的样本散布矩阵$A_G$和样本协方差矩阵$S_G$.
  $$
  \begin{align}
  A_G&=\sum_{i=1}^{n_G}(x_i-\bar{x}_G)(x_i-\bar{x}_G)^T\\
S_G&=\frac{1}{n_G-1}A_G
  \end{align}
  $$
  



## 3. 类与类的聚类

类与类之间的距离也称为连接。

- 最短距离或单连接

  定义类$G_p$的样本与$G_q$的样本之间的最短距离为两类之间的距离：
  $$
  D_{pq}=min\{d_{ij}|x_i \in G_p,x_j \in G_q\}
  $$
  

- 最长距离或完全连接

  定义类$G_p$的样本与$G_q$的样本之间的最长距离为两类之间的距离：
  $$
  D_{pq}=max\{d_{ij}|x_i \in G_p,x_j \in G_q\}
  $$

- 中心距离

  定义类$G_p$的样本与$G_q$的中心$\bar{x}_p$和$\bar{x}_q$的距离为两类之间的距离：
  $$
  D_{pq}=d_{\bar{x}_p\bar{x}_q}
  $$

- 平均距离

  定义类$G_p$的样本与$G_q$任意两个样本之间距离的平均值为两类之间的距离：
  $$
  D_{pq}=\frac{1}{n_pn_q}\sum_{x_i \in G_p}\sum_{x_j \in G_q}d_{ij}
  $$
  

